# 变更日志

## 2025-07-26

### 优化
- 简化 README.md 文件，移除过时和不必要的信息
- 更新 go.mod 文件，升级 beego 框架到 v2 版本
- 重构 server/server.go 文件，将全局变量封装到 Server 结构体中
- 在 proxy/base.go 中添加上下文支持，实现优雅关闭
- 在 common/util.go 中添加密码安全功能，使用 Argon2 算法进行密码哈希

### 依赖更新
- 更新 beego 从 v1.12.0 到 v2.1.0
- 更新 kcp-go 到 v5.4.20 正确版本
- 添加 golang.org/x/crypto 依赖用于密码安全功能

### 代码结构改进
- 引入 Server 结构体和单例模式管理服务实例
- 重构全局变量访问方式，提高代码可维护性
- 添加上下文支持，实现更好的资源管理

### 兼容性更新
- 更新所有 beego 导入路径以适配 v2 版本
- 修正相关 API 调用以符合新版本
### Bug修复
- 修复 npc_gui.go 中的 fmt.Errorf 参数不匹配问题
- 解决 cmd/npc 目录中 main 函数重复声明的问题
- 修复 config 包的测试用例问题

### 测试改进
- 修复 pmux 包中的端口冲突问题，更改测试端口从 8888 到 8899
- 修改 pmux 包避免在测试环境中直接调用 os.Exit
- 修改 nps_mux 包测试，使用本地回环地址替代 Docker 网络地址
- 为需要特定网络配置的测试添加跳过条件，提高测试可执行性
- 修复 nps_mux 包测试中的变量使用问题和导入问题